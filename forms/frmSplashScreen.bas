Version =20
VersionRequired =20
PublishOption =1
Checksum =-2120029010
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    BorderStyle =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =7920
    DatasheetFontHeight =11
    ItemSuffix =18
    Left =735
    Top =4635
    Right =17685
    Bottom =14880
    TimerInterval =500
    DatasheetGridlinesColor =16446942
    RecSrcDt = Begin
        0x3d85fa29174ce440
    End
    GUID = Begin
        0x2ddbc7958c4ed640b3f398ee5d098a5b
    End
    NameMap = Begin
        0x0acc0e5500000000000000000000000000000000000000000c00000005000000 ,
        0x0000000000000000000000000000
    End
    Caption ="Please Wait - Configuring ControlMIS..."
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x00c138100000000000000000030000003042be008842be00f2a61d7623000000 ,
        0x010403069c00b40743bf000201000100ea0a6f08640001000f00580202000100 ,
        0x5802030001004c65747465720000000000000000e43ebe00a95ee773303fbe00 ,
        0x0002000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000015010000ffffffff4749535500000000000000000000000044494e55 ,
        0x220010056c074800ab11edc40000000000000000000000000000000000000000 ,
        0x00000000000000002e0000000100000000000000000000000000000000000100 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000010050000534d544a ,
        0x0000000010000005000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000480000004d53445801000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001e003f000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000057 ,
        0x53442d30663962343538302d633737642d346234322d613438342d3538336337 ,
        0x336339343737342e3030363400000000000000000000000000
    End
    OnTimer ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    Moveable =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    PrtDevModeW = Begin
        0x0000bf007cb0223018a9bf0018a9bf00205f6b30e0a8bf00e4a8bf007cb02230 ,
        0xeca8bf007cb0223038a9bf0038a9bf00205f6b3010a9bf0038a9bf00205f6b30 ,
        0x01040306dc00b40743bf000201000100ea0a6f08640001000f00580202000100 ,
        0x5802030001004c006500740074006500720000000000000014004d0100000000 ,
        0x3ca9bf0044a9bf00450d423040a9bf000050d60ab4c4bf007180ea2fc0b46a2e ,
        0x44000000489c0000000000000000000000000000010000000000000001000000 ,
        0x0200000015010000ffffffff4749535500000000000000000000000044494e55 ,
        0x220010056c074800ab11edc40000000000000000000000000000000000000000 ,
        0x00000000000000002e0000000100000000000000000000000000000000000100 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000010050000534d544a ,
        0x0000000010000005000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000480000004d53445801000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x04001a003b000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000005700530044002d003000 ,
        0x66003900620034003500380030002d0063003700370064002d00340062003400 ,
        0x32002d0061003400380034002d00350038003300630037003300630039003400 ,
        0x3700370034002e00300030003600340000000000000000000000000000000000 ,
        0x00000000000000000000
    End
    NoSaveCTIWhenDisabled =1
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            Height =5760
            Name ="Detail"
            GUID = Begin
                0x5970dee46b43a54c8ef799cf8a94ad3e
            End
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin Image
                    SizeMode =1
                    PictureType =2
                    Width =7920
                    Height =5760
                    BorderColor =10921638
                    Name ="Image182"
                    Picture ="1_ControlSplash"
                    GUID = Begin
                        0xd64f8b8f349b884fa7bb7d4dcb26d628
                    End
                    GridlineColor =10921638
                    LayoutCachedWidth =7920
                    LayoutCachedHeight =5760
                    TabIndex =2
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =4020
                    Top =5100
                    Width =3720
                    ForeColor =4210752
                    Name ="cmdReconnect"
                    Caption ="Force Database Reconnect"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xa555530d964eaf4a8180b9345b696e9d
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4020
                    LayoutCachedTop =5100
                    LayoutCachedWidth =7740
                    LayoutCachedHeight =5460
                    BackColor =14732154
                    BorderColor =14732154
                    HoverColor =15392166
                    PressedColor =9402914
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4740
                    Top =2820
                    Width =2940
                    Height =1920
                    FontSize =8
                    FontWeight =700
                    TabIndex =1
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtProcessedIni"
                    GUID = Begin
                        0x184dfa163f52d8439eec154f4ec02a54
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4740
                    LayoutCachedTop =2820
                    LayoutCachedWidth =7680
                    LayoutCachedHeight =4740
                End
                Begin Label
                    FontItalic = NotDefault
                    OverlapFlags =247
                    Left =4740
                    Top =2520
                    Width =2940
                    Height =285
                    FontSize =9
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label3"
                    Caption ="Checking Required Links..."
                    GUID = Begin
                        0x89b46fa2366fad47a6ece6a55132276f
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4740
                    LayoutCachedTop =2520
                    LayoutCachedWidth =7680
                    LayoutCachedHeight =2805
                End
                Begin Label
                    OverlapFlags =247
                    TextAlign =3
                    Left =4980
                    Top =360
                    Width =2700
                    Height =1680
                    FontSize =16
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =4865149
                    Name ="Label7"
                    Caption ="MANAGEMENT\015\012INFORMATION\015\012SYSTEM FOR\015\012REAL PRINT SHOPS"
                    GUID = Begin
                        0x3d88210c87a57d4ca469cba2d3b3e44e
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4980
                    LayoutCachedTop =360
                    LayoutCachedWidth =7680
                    LayoutCachedHeight =2040
                    ForeThemeColorIndex =9
                    ForeTint =100.0
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Sub cmdReconnect_Click()

Me.TimerInterval = 0

Call LinkDB

DoCmd.Close
'Call Form_Timer




End Sub

Private Sub cmdReinstall_Click()


gblVersionInfo = GetVersionInfo
gblVersionInfo.SetupExe = "\\srv-edm-0006\AxisMIS\AxisInstall\setup.exe"
fWinShell gblVersionInfo.SetupExe, 1
Application.Quit

End Sub

Private Sub Form_Current()
'DoEvents


'Call loadall





End Sub


Sub loadall()

Dim myMachine As String
Dim db As Database
Dim myrs As Recordset
Dim fld As Field
Dim mysql As String

'Clean out the search fields in each srch local table so that a restart fixes up any previous search issues.
mysql = "SELECT * FROM srchFrmWIPPrint"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

mysql = "SELECT * FROM srchFrmWorkInProgressIncomplete"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

mysql = "SELECT * FROM srchFrmWorkInProgressOutsideServices"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

mysql = "SELECT * FROM srchFrmWorkInProgressProofsWaitingApproval"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

mysql = "SELECT * FROM srchFrmWorkInProgressPurchasing"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

mysql = "SELECT * FROM srchFrmWorkInProgressReadyToInvoice"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

mysql = "SELECT * FROM srchFrmWorkInProgressReadyToShip"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

mysql = "SELECT * FROM srchFrmWorkInProgressWaitingForArtwork"
Set myrs = CurrentDb.OpenRecordset(mysql)
myrs.Edit
For Each fld In myrs.Fields
    If fld.name <> "fraShowBy" Then
        fld.Value = Null
    End If
Next
myrs.Update
myrs.Close

Set myrs = Nothing






'This should be where we check for new versions, and then call the reinstall procedure... Also there should be a way to compare INI files
'to see if any new information is there, and then trigger a redo.

'Right now, just force a copy of the standard ini file for the company.
Dim myIniFileName As String

myIniFileName = CurrentProject.Path & "\setup.ini"

'If (Len(Dir(myIniFileName)) = 0) Then
    'MsgBox "INI File does not exist in folder."
'FileCopy "\\srv-edm-0003\Office\AxisMIS\Program\SetupSTD.ini", myIniFileName 'For now so that workstations don't fail on startup, copy default file from SRV-EDM-0003 install folder - will handle differently later
    
'End If

'Set the public search settings table up
Set rsLocSS = CurrentDb.OpenRecordset("loc_SearchSettings", dbOpenDynaset)

'Set Local Constants
cMyBackColor = RGB(225, 255, 225)
cmyFontColor = RGB(169, 1, 30)

'Set Company Color Scheme
cLocColor01 = 15523798
cLocColor02 = 12428174
cLocColor03 = 13816815
cLocColor04 = 10856415
cLocColor05 = 14151142
cLocColor06 = 11525325
cLocColor07 = 15195103
cLocColor08 = 15523798
cLocColor09 = 15788753
cLocColor10 = 14865828
cLocColor11 = 13952764
cLocColor12 = 11193849



' load all constants from setup.ini
   
'Sections follow for AXIS, PDQ, KSTATION, SAGE50, QUICKBOOKS, SMARTSTREAM, PITSTOPSERVER, UPLOADPORTAL

cControlCompanyCode = ReadIniFileString("CONTROL", "ControlCompanyCode")

If cControlCompanyCode = "KS" Then
    Set db = CurrentDb
    db.Properties("AppIcon").Value = CurrentProject.Path & "\icons\ico\KS.ico"
    db.Properties("AppTitle").Value = "KingSign"
    db.Properties("UseAppIconForFrmRpt").Value = True
    Application.RefreshTitleBar
Else
    Set db = CurrentDb
    db.Properties("AppIcon").Value = CurrentProject.Path & "\icons\ico\Control.ico"
    db.Properties("AppTitle").Value = "Control"
    db.Properties("UseAppIconForFrmRpt").Value = True
    Application.RefreshTitleBar
End If

cControlEstimateFolder = ReadIniFileString("CONTROL", "ControlEstimateFolder")
cControlInvoiceFolder = ReadIniFileString("CONTROL", "ControlInvoiceFolder")
cControlEstimateAttachmentFolder = ReadIniFileString("CONTROL", "ControlEstimateAttachmentFolder")
cControlDocketAttachmentFolder = ReadIniFileString("CONTROL", "ControlDocketAttachmentFolder")
cControlProofFolder = ReadIniFileString("CONTROL", "ControlProofFolder")
cControlLocalProgramFolder = ReadIniFileString("CONTROL", "ControlLocalProgramFolder")
cControlServerUseWindowsAuthentication = ReadIniFileString("CONTROL", "ControlServerUseWindowsAuthentication")
cControlServer = ReadIniFileString("CONTROL", "ControlServer")
cControlDatabase = ReadIniFileString("CONTROL", "ControlDatabase")
cControlUser = ReadIniFileString("CONTROL", "ControlUser")
cControlPassword = ReadIniFileString("CONTROL", "ControlPassword")
cControlCountry = ReadIniFileString("CONTROL", "ControlCountry")
cControlProv = ReadIniFileString("CONTROL", "ControlProv")
cControlCity = ReadIniFileString("CONTROL", "ControlCity")

Dim myBackSlash As String
myBackSlash = InStr(cControlServer, "\")
If myBackSlash = 0 Then myBackSlash = Len(cControlServer)
myMachine = Left(cControlServer, myBackSlash - 1)



If Len(myMachine) > 0 Then

    'If PingServer(myMachine) = True Then
        Me.txtProcessedIni = "Found CONTROL Database" & vbCrLf & vbCrLf
    'Else
    '    MsgBox "CONTROL Server at " & myMachine & " not found. CONTROL cannot continue without the main database. Aborting program.", vbCritical, ProgramName
    '    Application.Quit

    'End If

Else
    Me.txtProcessedIni = "CONTROL Server not found. Aborting program." & vbCrLf & vbCrLf
    Exit Sub
End If

myMachine = ""

DoEvents






cPDQEnabled = ReadIniFileString("PDQ", "PDQEnabled")
cPDQDatabase = ReadIniFileString("PDQ", "PDQDatabase")
cPDQQuoteXMLFolder = ReadIniFileString("PDQ", "PDQQuoteXMLFolder")
cPDQSetupDatabase = ReadIniFileString("PDQ", "PDQSetupDatabase")

If cPDQEnabled Then Me.txtProcessedIni = Me.txtProcessedIni & "Link to PDQ Estimating Enabled." & vbCrLf

DoEvents

cKStationEnabled = ReadIniFileString("KSTATION", "KStationEnabled")
cKStationServer = ReadIniFileString("KSTATION", "KStationServer")
cKStationDatabase = ReadIniFileString("KSTATION", "KStationDatabase")
cKStationUser = ReadIniFileString("KSTATION", "KStationUser")
cKStationPassword = ReadIniFileString("KSTATION", "KStationPassword")

myBackSlash = InStr(cKStationServer, "\")
If myBackSlash = 0 Then myBackSlash = Len(cKStationServer)
myMachine = Left(cKStationServer, myBackSlash - 1)


If cKStationEnabled Then
    If Len(myMachine) > 2 Then
        If PingServer(myMachine) = True Then
            Me.txtProcessedIni = Me.txtProcessedIni & "Link to Komori K-Station Enabled." & vbCrLf
        Else
            cKStationEnabled = False
            Me.txtProcessedIni = Me.txtProcessedIni & "Link to Komori K-Station FAILED - Server Not Available." & vbCrLf
        End If
    Else
        cKStationEnabled = False
        Me.txtProcessedIni = Me.txtProcessedIni & "Link to Komori K-Station FAILED - Server Name Incorrect." & vbCrLf
    End If
End If

DoEvents


cSage50Enabled = ReadIniFileString("SAGE50", "Sage50Enabled")
cSage50Folder = ReadIniFileString("SAGE50", "Sage50Folder")
cSage50ExportFolder = ReadIniFileString("SAGE50", "Sage50ExportFolder")
cSage50DataFile = ReadIniFileString("SAGE50", "Sage50DataFile")
cSage50User = ReadIniFileString("SAGE50", "Sage50User")
cSage50Password = ReadIniFileString("SAGE50", "Sage50Password")




If cSage50Enabled Then Me.txtProcessedIni = Me.txtProcessedIni & "Link to Sage 50 Accounting Enabled." & vbCrLf
DoEvents

cQuickbooksEnabled = ReadIniFileString("QUICKBOOKS", "QuickbooksEnabled")
cQuickbooksProgramFolder = ReadIniFileString("QUICKBOOKS", "QuickbooksProgramFolder")
cQuickbooksExportFolder = ReadIniFileString("QUICKBOOKS", "QuickbooksExportFolder")
cQuickbooksDataFile = ReadIniFileString("QUICKBOOKS", "QuickbooksDataFile")
cQuickBooksUser = ReadIniFileString("QUICKBOOKS", "QuickbooksUser")
cQuickBooksPassword = ReadIniFileString("QUICKBOOKS", "QuickbooksPassword")

If cQuickbooksEnabled Then Me.txtProcessedIni = Me.txtProcessedIni & "Link to Quickbooks Enabled." & vbCrLf
DoEvents

cSmartStreamEnabled = ReadIniFileString("SMARTSTREAM", "SmartStreamEnabled")
cSmartStreamServer = ReadIniFileString("SMARTSTREAM", "SmartStreamServer")
cSmartStreamDatabase = ReadIniFileString("SMARTSTREAM", "SmartStreamDatabase")
cSmartStreamUser = ReadIniFileString("SMARTSTREAM", "SmartStreamUser")
cSmartStreamPassword = ReadIniFileString("SMARTSTREAM", "SmartStreamPassword")
cSmartStreamJobFolder = ReadIniFileString("SMARTSTREAM", "SmartStreamJobFolder")

myBackSlash = InStr(cSmartStreamServer, "\")
If myBackSlash = 0 Then myBackSlash = Len(cSmartStreamServer)
myMachine = Left(cSmartStreamServer, myBackSlash - 1)

If cSmartStreamEnabled Then
    If Len(myMachine) > 2 Then
        If PingServer(myMachine) = True Then
            Me.txtProcessedIni = Me.txtProcessedIni & "Link to SmartStream Enabled." & vbCrLf
        Else
            cSmartStreamEnabled = False
            Me.txtProcessedIni = Me.txtProcessedIni & "Link to SmartStream FAILED - Server Not Available." & vbCrLf
        End If
    Else
        cSmartStreamEnabled = False
        Me.txtProcessedIni = Me.txtProcessedIni & "Link to SmartStream FAILED - Server Name Incorrect." & vbCrLf
    End If
End If

DoEvents


cPitStopServerEnabled = ReadIniFileString("PITSTOPSERVER", "PitStopServerEnabled")
cPitStopServerProgramFolder = ReadIniFileString("PITSTOPSERVER", "PitStopServerProgramFolder")
cPitStopServerInputFolder = ReadIniFileString("PITSTOPSERVER", "PitStopServerInputFolder")
cPitStopServerOutputFolder = ReadIniFileString("PITSTOPSERVER", "PitStopServerOutputFolder")

If cPitStopServerEnabled Then Me.txtProcessedIni = Me.txtProcessedIni & "Link to Pitstop Server Enabled." & vbCrLf
DoEvents

cUploadPortalEnabled = ReadIniFileString("UPLOADPORTAL", "UploadPortalEnabled")
cUploadPortalSite = ReadIniFileString("UPLOADPORTAL", "UploadPortalSite")


myMachine = Right(cUploadPortalSite, Len(cUploadPortalSite) - InStr(cUploadPortalSite, "//") - 1) 'strip off the http://
myBackSlash = InStr(myMachine, "/")
If myBackSlash = 0 Then myBackSlash = Len(myMachine)
myMachine = Trim(Left(myMachine, myBackSlash - 1))


'Not using the Pingserver currently as it fails randomly for the IP address. Maybe too slow?

If cUploadPortalEnabled Then
     Me.txtProcessedIni = Me.txtProcessedIni & "Link to Upload Portal Enabled." & vbCrLf  'Temporary line while ignoring code below
'    If Len(myMachine) > 2 Then
'        If PingServer(myMachine) = True Then
'            Me.txtProcessedIni = Me.txtProcessedIni & "Link to Upload Portal Enabled." & vbCrLf
'        Else
'            cUploadPortalEnabled = False
'            Me.txtProcessedIni = Me.txtProcessedIni & "Link to Upload Portal FAILED - Server Not Available." & vbCrLf
'        End If
'    Else
'        cUploadPortalEnabled = False
'        Me.txtProcessedIni = Me.txtProcessedIni & "Link to Upload Portal FAILED - Server Name Incorrect." & vbCrLf
'    End If
End If



'Clean up local databases

DoCmd.SetWarnings False

DoCmd.RunSQL "DELETE * FROM loc_BatchPrint"

DoCmd.SetWarnings True


DoEvents



'Me.TimerInterval = 2000 'Show for two more seconds in case user has to force a reconnect, then let the timer action close


End Sub

Private Sub Form_Load()
DoCmd.RunCommand acCmdAppMaximize

End Sub

Private Sub Form_Timer()

Me.TimerInterval = 0

DoEvents
Call loadall

Sleep (2000)

'Call cmdReconnect_Click

DoCmd.Close acForm, "frmSplashScreen"

End Sub