Version =20
VersionRequired =20
PublishOption =1
Checksum =1721976578
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =13680
    DatasheetFontHeight =11
    ItemSuffix =14
    Left =3945
    Top =8775
    Right =18015
    Bottom =12945
    DatasheetGridlinesColor =16446942
    RecSrcDt = Begin
        0x0aa7de70cf62e440
    End
    GUID = Begin
        0xf1c340067985214b941a42b6965854c2
    End
    NameMap = Begin
        0x0acc0e5500000000d315f2e6430a754cb2745d3f8bfdd98e0000000045ba29a1 ,
        0x0da8e4400000000000000000710072007900500072006f006a00650063007400 ,
        0x480065006100640065007200570061007400630068004c006900730074000000 ,
        0x000000007774c05d713b4f42958e9bacbed064b507000000d315f2e6430a754c ,
        0xb2745d3f8bfdd98e440075006500440061007400650000000000000012e32f81 ,
        0xde9b7942901c8776d19feff907000000d315f2e6430a754cb2745d3f8bfdd98e ,
        0x44006f0063006b00650074004e0075006d00000000000000ba6dd67022d47249 ,
        0x9f44b6ee375d8ddd07000000d315f2e6430a754cb2745d3f8bfdd98e51007500 ,
        0x6f00740065004e0075006d00000000000000bb1a4c05fd41ba4394880a27754c ,
        0x80a007000000d315f2e6430a754cb2745d3f8bfdd98e43006f006d0070004e00 ,
        0x61006d006500000000000000c916d84dfa3c6e4fbbb0419aa63bd12e07000000 ,
        0xd315f2e6430a754cb2745d3f8bfdd98e570061007400630068004e006f007400 ,
        0x65007300000000000000c19850f7e8dcfe4e8b76ca8c2ef9010d07000000d315 ,
        0xf2e6430a754cb2745d3f8bfdd98e490053005200550053004800000000000000 ,
        0x000000000000000000000000000000000c000000050000000000000000000000 ,
        0x000000000000
    End
    RecordSource ="qryProjectHeaderWatchList"
    DatasheetFontName ="Calibri"
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =240
            BackColor =14342874
            Name ="FormHeader"
            GUID = Begin
                0xcce08effaed8a043b24943697d106aa4
            End
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
            Begin
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Width =840
                    Height =240
                    FontSize =9
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label7"
                    Caption ="QUOTE"
                    GUID = Begin
                        0xd09b2e4345e47e45b40ffb1225c97e60
                    End
                    GridlineColor =10921638
                    LayoutCachedWidth =840
                    LayoutCachedHeight =240
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =2
                    Left =840
                    Width =840
                    Height =240
                    FontSize =9
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label8"
                    Caption ="DOCKET"
                    GUID = Begin
                        0xc2d1c47da9c16342b3ff628e23173f06
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =840
                    LayoutCachedWidth =1680
                    LayoutCachedHeight =240
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =2
                    Left =1680
                    Width =1080
                    Height =240
                    FontSize =9
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label9"
                    Caption ="DUE DATE"
                    GUID = Begin
                        0x3279b580e97e184b95d72e6949fbff24
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =1680
                    LayoutCachedWidth =2760
                    LayoutCachedHeight =240
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =2
                    Left =2760
                    Width =3000
                    Height =240
                    FontSize =9
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label10"
                    Caption ="CLIENT"
                    GUID = Begin
                        0x296895eb8152aa4caa9137c86bbf261e
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =2760
                    LayoutCachedWidth =5760
                    LayoutCachedHeight =240
                End
                Begin Label
                    OverlapFlags =87
                    TextAlign =2
                    Left =5760
                    Width =6480
                    Height =240
                    FontSize =9
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label11"
                    Caption ="REASON TO WATCH"
                    GUID = Begin
                        0x64cc9a07f335d5498aaadc66c6316ba8
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =5760
                    LayoutCachedWidth =12240
                    LayoutCachedHeight =240
                End
            End
        End
        Begin Section
            Height =240
            Name ="Detail"
            GUID = Begin
                0x6539739fd98a714ea3089dd7bf9cc365
            End
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OverlapFlags =93
                    TextAlign =2
                    IMESentenceMode =3
                    Left =1680
                    Width =1080
                    FontSize =9
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="DueDate"
                    ControlSource ="DueDate"
                    Format ="Medium Date"
                    GUID = Begin
                        0x9b15bd5f47b8174fa8ca0c0faacf4622
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =1680
                    LayoutCachedWidth =2760
                    LayoutCachedHeight =240
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    OverlapFlags =95
                    TextAlign =2
                    IMESentenceMode =3
                    Left =840
                    Width =840
                    FontSize =9
                    TabIndex =1
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="DocketNum"
                    ControlSource ="DocketNum"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x4c0a2c1c786e864fac2168c26653173e
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =840
                    LayoutCachedWidth =1680
                    LayoutCachedHeight =240
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    OverlapFlags =87
                    TextAlign =2
                    IMESentenceMode =3
                    Width =840
                    FontSize =9
                    TabIndex =2
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="QuoteNum"
                    ControlSource ="QuoteNum"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x7f09b4d5bb4fab46ad9fb406c0b250cd
                    End
                    GridlineColor =10921638

                    LayoutCachedWidth =840
                    LayoutCachedHeight =240
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OverlapFlags =95
                    IMESentenceMode =3
                    Left =2760
                    Width =3000
                    ColumnWidth =4380
                    FontSize =9
                    TabIndex =3
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="CompName"
                    ControlSource ="CompName"
                    GUID = Begin
                        0x6a47c61c255eb64191b00bf1a3bee67b
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =2760
                    LayoutCachedWidth =5760
                    LayoutCachedHeight =240
                End
                Begin TextBox
                    OverlapFlags =95
                    IMESentenceMode =3
                    Left =5760
                    Width =6480
                    ColumnWidth =2040
                    FontSize =9
                    TabIndex =4
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="WatchNotes"
                    ControlSource ="WatchNotes"
                    StatusBarText ="Notes as to why you are watching this project."
                    GUID = Begin
                        0x8976680780fc59459f6cec9d21c07078
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =5760
                    LayoutCachedWidth =12240
                    LayoutCachedHeight =240
                End
                Begin TextBox
                    OverlapFlags =87
                    TextAlign =2
                    IMESentenceMode =3
                    Left =12240
                    Width =840
                    FontSize =9
                    TabIndex =5
                    BackColor =15527148
                    BorderColor =10921638
                    ForeColor =15527148
                    Name ="Text12"
                    ControlSource ="=\"RUSH\""
                    ConditionalFormat = Begin
                        0x010000007e000000010000000100000000000000000000000e00000001010000 ,
                        0xba141900ececec00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b004900530052005500530048005d003d00540072007500650000000000
                    End
                    GUID = Begin
                        0x1a216644b0452242a5bbaf16c463f4df
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =12240
                    LayoutCachedWidth =13080
                    LayoutCachedHeight =240
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    ConditionalFormat14 = Begin
                        0x010001000000010000000000000001010000ba141900ececec000d0000005b00 ,
                        0x4900530052005500530048005d003d0054007200750065000000000000000000 ,
                        0x00000000000000000000000000
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="FormFooter"
            GUID = Begin
                0x0fb573b8142bb1499caccaa77a169222
            End
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub DocketNum_Click()
Call QuoteNum_Click

End Sub

Private Sub Form_Load()
'Following two lines are required to ensure the entire database loads and doesn't leave tables in "SUSPEND" on SQL server.
If Me.Recordset.RecordCount > 0 Then
    Me.Recordset.MoveLast
    Me.Recordset.MoveFirst
End If
End Sub

Private Sub QuoteNum_Click()
tmpProjectID = Me!ProjectHeaderID

'Pass control to OpenProject and skip all other code.
Call OpenProject(tmpProjectID)
Exit Sub


tmpControlNum = 0
tmpcontrolnumavail = 0

tmpInvoiceNum = DLookup("[InvoiceNum]", "dbo_projectHeader", "[ID] = " & Me.ProjectHeaderID)
tmpDocketNum = DLookup("[DocketNum]", "dbo_projectHeader", "[ID] = " & Me.ProjectHeaderID)
tmpQuoteNum = DLookup("[QuoteNum]", "dbo_projectHeader", "[ID] = " & Me.ProjectHeaderID)
tmpProjectName = DLookup("[ProjectName]", "dbo_projectHeader", "[ID] = " & Me.ProjectHeaderID)
tmpCompName = DLookup("[CompName]", "dbo_contactgeneral", "[ID] = " & Me.ContactGeneralID)

'FIND OUT IF project IS ALREADY OPEN - IF IT IS, KILL IT, so it will reappear at top.

'GoTo skip5layout:
For i = 1 To cNumProjectsOpen
    strcontrolname = "navProject" & Format(i, "00")
    If Val(Forms!navmaster(strcontrolname).tag) = Val(tmpProjectID) Then
        Forms!navmaster(strcontrolname).tag = ""
        Forms!navmaster(strcontrolname).caption = Forms!navmaster(strcontrolname).name
        Forms!navmaster(strcontrolname).visible = False
        
        
        For j = i To (cNumProjectsOpen - 1) 'if you delete one, suck them up from below
        strcontrolname1 = "navProject" & Format(j, "00")
        strcontrolname2 = "navProject" & Format(j + 1, "00")
        
        Forms!navmaster(strcontrolname1).visible = Forms!navmaster(strcontrolname2).visible
        Forms!navmaster(strcontrolname1).tag = Forms!navmaster(strcontrolname2).tag
        Forms!navmaster(strcontrolname1).caption = Forms!navmaster(strcontrolname2).caption
        Forms!navmaster(strcontrolname1).NavigationWhereClause = Forms!navmaster(strcontrolname2).NavigationWhereClause
        Next
        

    
        
    End If
Next


 ' bump everybody down one onscreen.

    For i = 5 To 2 Step -1
        strcontrolname1 = "navProject" & Format(i, "00")
        strcontrolname2 = "navProject" & Format(i - 1, "00")
        
        Forms!navmaster(strcontrolname1).visible = Forms!navmaster(strcontrolname2).visible
        Forms!navmaster(strcontrolname1).tag = Forms!navmaster(strcontrolname2).tag
        Forms!navmaster(strcontrolname1).caption = Forms!navmaster(strcontrolname2).caption
        Forms!navmaster(strcontrolname1).NavigationWhereClause = Forms!navmaster(strcontrolname2).NavigationWhereClause

        
    Next

skip5layout:

mytab = "" 'set up the tab information.
If tmpInvoiceNum > 0 Then
    mytab = "INV " & tmpInvoiceNum
    Else
        If tmpDocketNum > 0 Then
            mytab = "DKT " & tmpDocketNum
        Else
            mytab = "EST " & tmpQuoteNum
    End If
End If
mytab = mytab & vbCrLf
mytab = mytab & Trim(Left(tmpCompName, 15)) & IIf(Len(tmpCompName) > 15, "...", "") & vbCrLf
mytab = mytab & Trim(Left(tmpProjectName, 15)) & IIf(Len(tmpProjectName) > 15, "...", "")




' go to the first tab and turn it on.

tmpControlNum = 1
strcontrolname = "navProject" & Format(tmpControlNum, "00")
Forms!navmaster(strcontrolname).visible = True
Forms!navmaster(strcontrolname).caption = mytab
Forms!navmaster(strcontrolname).tag = tmpProjectID


tmpWhereClause = "[id] = " & Val(tmpProjectID)

Forms!navmaster(strcontrolname).NavigationWhereClause = tmpWhereClause


'Browse to root of screen first. - OLD CODE - ERRORS

'DoCmd.BrowseTo acBrowseToForm, "navProject", "navMaster.navsubform", tmpwhereclause

'Me.Repaint

'DoCmd.BrowseTo acBrowseToForm, "frmProjectGeneral", "navMaster.navSubform>navProject.navigationSubform", tmpwhereclause

'DoCmd.BrowseTo acBrowseToForm, "navProject", , tmpwhereclause ' this one doesn't work right.


Forms!navmaster.SetFocus                'These two setfocus commands are NEEDED to browse properly
Forms!navmaster.NavProject01.SetFocus


DoCmd.BrowseTo acBrowseToForm, "navProject", "navMaster.navSubform", tmpWhereClause
End Sub