Version =20
VersionRequired =20
PublishOption =1
Checksum =-910532453
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    BorderStyle =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =7920
    DatasheetFontHeight =11
    ItemSuffix =6
    Left =10410
    Top =2565
    Right =18330
    Bottom =8310
    DatasheetGridlinesColor =16446942
    RecSrcDt = Begin
        0x7d11e451acc8e440
    End
    GUID = Begin
        0xeda891e4e712f94d8ddc496897a78112
    End
    NameMap = Begin
        0x0acc0e55000000006c8bebb00293e84d8a5b3ade081409e5000000000fe27a6d ,
        0xec62e440000000000000000074006d007000430062006f004c006f0067006900 ,
        0x6e004c0069007300740000000000000000000000000000000000000000000000 ,
        0x0c000000050000000000000000000000000000000000
    End
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010403069c00e80343bf000201000100ea0a6f08640001000f00ffff01000100 ,
        0xffff030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000044010000ffffffff4749533400000000000000000000000044494e55 ,
        0x22007001cc031c009462ef2a0000000000000000000000000000000000000000 ,
        0x00000000000000000c0000000100000000000000000000000100000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000070010000534d544a ,
        0x00000000100060017b00460032003400320032003000310031002d0035003300 ,
        0x460035002d0034003200390065002d0038003900450032002d00310037003500 ,
        0x4300460037003200300041003900320030007d000000496e70757442696e0041 ,
        0x75746f53656c65637400524553444c4c00556e69726573444c4c005061706572 ,
        0x53697a65004c4554544552004f7269656e746174696f6e00504f525452414954 ,
        0x004d6564696154797065004175746f005265736f6c7574696f6e003630304450 ,
        0x4900506167654f75747075745175616c697479004e6f726d616c00436f6c6f72 ,
        0x4d6f6465004d6f6e6f00446f63756d656e744e5570003100436f6c6c61746500 ,
        0x4f4e004475706c6578004e4f4e45004f757470757442696e004175746f000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000001c0000005634444d01000000000000000000000000000000 ,
        0x00000000
    End
    PrtDevNames = Begin
        0x08002c0055000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000005553423030320000000000 ,
        0x00000000
    End
    OnLoad ="[Event Procedure]"
    Moveable =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    PrtDevModeW = Begin
        0x0000310064000000a02b57030000a406710814775815a40600000000b8151477 ,
        0xb188fc4b480000000000a4063c0000009e080101850000005203005160025703 ,
        0x01040306dc00e80343bf000201000100ea0a6f08640001000f00ffff01000100 ,
        0xffff030001004c00650074007400650072000000b7fcffffb20a2c00b7fcffff ,
        0x5c1cfd005815a406c94efee700ff0000b20a2c00f047fd00f0e52e769d7e3791 ,
        0xfeffffff281c0000000000000000000000000000010000000000000001000000 ,
        0x0200000044010000ffffffff4749533400000000000000000000000044494e55 ,
        0x22007001cc031c009462ef2a0000000000000000000000000000000000000000 ,
        0x00000000000000000c0000000100000000000000000000000100000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000070010000534d544a ,
        0x00000000100060017b00460032003400320032003000310031002d0035003300 ,
        0x460035002d0034003200390065002d0038003900450032002d00310037003500 ,
        0x4300460037003200300041003900320030007d000000496e70757442696e0041 ,
        0x75746f53656c65637400524553444c4c00556e69726573444c4c005061706572 ,
        0x53697a65004c4554544552004f7269656e746174696f6e00504f525452414954 ,
        0x004d6564696154797065004175746f005265736f6c7574696f6e003630304450 ,
        0x4900506167654f75747075745175616c697479004e6f726d616c00436f6c6f72 ,
        0x4d6f6465004d6f6e6f00446f63756d656e744e5570003100436f6c6c61746500 ,
        0x4f4e004475706c6578004e4f4e45004f757470757442696e004175746f000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000001c0000005634444d01000000000000000000000000000000 ,
        0x00000000
    End
    PrtDevNamesW = Begin
        0x0400280051000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000550053004200300030003200000000000000000000000000000000000000
    End
    NoSaveCTIWhenDisabled =1
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            Height =5760
            Name ="Detail"
            GUID = Begin
                0xa7e81676267826439c012e8fa7cecadd
            End
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin Image
                    SizeMode =1
                    PictureType =2
                    Width =7920
                    Height =5760
                    BorderColor =10921638
                    Name ="Image182"
                    Picture ="1_ControlSplash"
                    GUID = Begin
                        0x9c0e2e984464af419efbac70a43a3845
                    End
                    GridlineColor =10921638
                    LayoutCachedWidth =7920
                    LayoutCachedHeight =5760
                    TabIndex =4
                End
                Begin OptionGroup
                    OverlapFlags =247
                    Left =1920
                    Top =5040
                    Width =4262
                    Height =538
                    TabIndex =2
                    BorderColor =10921638
                    Name ="frmScreenMode"
                    DefaultValue ="1"
                    GUID = Begin
                        0xdf765eb58ae5894b85096cb01b22f0a6
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =1920
                    LayoutCachedTop =5040
                    LayoutCachedWidth =6182
                    LayoutCachedHeight =5578
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            TextAlign =2
                            Left =2025
                            Top =4860
                            Width =4035
                            Height =255
                            FontSize =8
                            BorderColor =8355711
                            ForeColor =12349952
                            Name ="Label9"
                            Caption ="SCREEN MODE: (Tablet and Phone Mode In Development)"
                            GUID = Begin
                                0x8a019d76a8c25e449261fd6e27ad57a9
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =2025
                            LayoutCachedTop =4860
                            LayoutCachedWidth =6060
                            LayoutCachedHeight =5115
                            BackThemeColorIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =247
                            Left =2100
                            Top =5248
                            OptionValue =1
                            BorderColor =10921638
                            Name ="Option11"
                            GUID = Begin
                                0x0cb54a80d8c48640b778a7ccfc5e6a15
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =2100
                            LayoutCachedTop =5248
                            LayoutCachedWidth =2360
                            LayoutCachedHeight =5488
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =2325
                                    Top =5220
                                    Width =810
                                    Height =285
                                    FontSize =10
                                    BorderColor =8355711
                                    ForeColor =12349952
                                    Name ="Label12"
                                    Caption ="DESKTOP"
                                    GUID = Begin
                                        0x1ccb6eeb64ef3d49b7fcc703b552713e
                                    End
                                    GridlineColor =10921638
                                    LayoutCachedLeft =2325
                                    LayoutCachedTop =5220
                                    LayoutCachedWidth =3135
                                    LayoutCachedHeight =5505
                                    ForeThemeColorIndex =-1
                                    ForeTint =100.0
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =247
                            Left =3420
                            Top =5248
                            OptionValue =2
                            BorderColor =10921638
                            Name ="Option13"
                            GUID = Begin
                                0xdd51da0a33e2b547802025a8b3ec6890
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =3420
                            LayoutCachedTop =5248
                            LayoutCachedWidth =3680
                            LayoutCachedHeight =5488
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3645
                                    Top =5220
                                    Width =630
                                    Height =285
                                    FontSize =10
                                    BorderColor =8355711
                                    ForeColor =12349952
                                    Name ="Label14"
                                    Caption ="TABLET"
                                    GUID = Begin
                                        0xc91d5485358f4c4e99e80bbcc5b5be84
                                    End
                                    GridlineColor =10921638
                                    LayoutCachedLeft =3645
                                    LayoutCachedTop =5220
                                    LayoutCachedWidth =4275
                                    LayoutCachedHeight =5505
                                    ForeThemeColorIndex =-1
                                    ForeTint =100.0
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =247
                            Left =4560
                            Top =5248
                            OptionValue =3
                            BorderColor =10921638
                            Name ="Option15"
                            GUID = Begin
                                0x849b27c71bd3e549ba2572d77ec26294
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =4560
                            LayoutCachedTop =5248
                            LayoutCachedWidth =4820
                            LayoutCachedHeight =5488
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =4785
                                    Top =5220
                                    Width =1275
                                    Height =285
                                    FontSize =10
                                    BorderColor =8355711
                                    ForeColor =12349952
                                    Name ="Label16"
                                    Caption ="SMARTPHONE"
                                    GUID = Begin
                                        0x537edef6bcd07e429096f985192f55d6
                                    End
                                    GridlineColor =10921638
                                    LayoutCachedLeft =4785
                                    LayoutCachedTop =5220
                                    LayoutCachedWidth =6060
                                    LayoutCachedHeight =5505
                                    ForeThemeColorIndex =-1
                                    ForeTint =100.0
                                End
                            End
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =247
                    IMESentenceMode =3
                    ColumnCount =3
                    Left =4740
                    Top =1500
                    Width =3000
                    Height =315
                    FontWeight =700
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"510\""
                    GUID = Begin
                        0xa48061706b866044b193d2f694d2caec
                    End
                    Name ="cboSelectUser"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT * FROM tmpCboLoginList; "
                    ColumnWidths ="0;1440;0"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    LayoutCachedLeft =4740
                    LayoutCachedTop =1500
                    LayoutCachedWidth =7740
                    LayoutCachedHeight =1815
                    ForeThemeColorIndex =0
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =4560
                            Top =1200
                            Width =1080
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label1"
                            Caption ="USER:"
                            GUID = Begin
                                0x68a4ec44690e1e4097c4fc5812456e82
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =4560
                            LayoutCachedTop =1200
                            LayoutCachedWidth =5640
                            LayoutCachedHeight =1515
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =4560
                    Top =3900
                    Width =3120
                    Height =600
                    FontWeight =700
                    TabIndex =3
                    ForeColor =1643706
                    Name ="cmdShowProductionStations"
                    Caption ="Click HERE for a list of \015\012Production Stations"
                    GUID = Begin
                        0xd8c71d796cc9744095bce8d5b7092fa6
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4560
                    LayoutCachedTop =3900
                    LayoutCachedWidth =7680
                    LayoutCachedHeight =4500
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    BackColor =14732154
                    BorderColor =14732154
                    HoverColor =15392166
                    PressedColor =9402914
                    HoverForeColor =1643706
                    HoverForeThemeColorIndex =-1
                    HoverForeTint =100.0
                    PressedForeColor =1643706
                    PressedForeThemeColorIndex =-1
                    PressedForeTint =100.0
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin Label
                    FontItalic = NotDefault
                    OverlapFlags =247
                    TextAlign =2
                    Left =780
                    Top =300
                    Width =6360
                    Height =405
                    FontSize =14
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =1643706
                    Name ="lblWelcome"
                    Caption ="Welcome to ControlMIS - Please Log In to Continue..."
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xd4dd3627bd08d341b34d6c13926ce33f
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =780
                    LayoutCachedTop =300
                    LayoutCachedWidth =7140
                    LayoutCachedHeight =705
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin TextBox
                    OverlapFlags =247
                    IMESentenceMode =3
                    Left =4740
                    Top =2340
                    Width =3000
                    Height =315
                    FontWeight =700
                    TabIndex =1
                    BorderColor =10921638
                    Name ="txtEnterPassword"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    InputMask ="Password"
                    GUID = Begin
                        0xee402c26e6908d44b6d7292710558490
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4740
                    LayoutCachedTop =2340
                    LayoutCachedWidth =7740
                    LayoutCachedHeight =2655
                    ForeTint =100.0
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =4560
                            Top =2040
                            Width =1200
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label3"
                            Caption ="PASSWORD:"
                            GUID = Begin
                                0xc830acbb051607418c282f92cf2ffe21
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =4560
                            LayoutCachedTop =2040
                            LayoutCachedWidth =5760
                            LayoutCachedHeight =2355
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub cboSelectUser_AfterUpdate()


If Me.cboSelectUser.Column(2) <> "xxx" Then
    'If first three letters aren't xxx, This is a user - Carry on to password as normal
Else

    
    DoCmd.OpenForm "frmLogin", acNormal, , "[EmployeeID] = 70"
    
    Forms!frmLogin.txtSystemBarcode = Me.cboSelectUser
    
    Call Forms("frmLogin").txtSystemBarcode_AfterUpdate

    
    
    DoCmd.Close acForm, "frmGetPassword"

End If


End Sub

Private Sub Form_Load()

Dim myRST As Recordset
Dim myRST2 As Recordset
Dim mysql As String

'Clear out login list.

DoCmd.SetWarnings False
mysql = "DELETE * FROM tmpCboLoginList"
DoCmd.RunSQL (mysql)

DoCmd.SetWarnings True


Set myRST2 = CurrentDb.OpenRecordset("tmpCboLoginList", dbOpenDynaset)


mysql = "SELECT * FROM qryCboEmployeeLogin"

Set myRST = CurrentDb.OpenRecordset(mysql, dbOpenDynaset, dbSeeChanges)
myRST.MoveFirst
myLoginInfo = ""




Do Until myRST.EOF
    If myRST!IsActive = True Then
        myRST2.AddNew
        myRST2!ID = myRST!ID
        myRST2!FULLNAME = myRST![FN] & " " & myRST![LN]
        myRST2!Password = myRST![Password]
        myRST2.Update
        
    End If
    myRST.MoveNext
    
Loop
'Preloaded all of the Users - Next, add Stations

myRST.Close


'Stations are added to the list at the end of the list.


Set myRST = CurrentDb.OpenRecordset("dbo_Station", dbOpenDynaset, dbSeeChanges)

Do Until myRST.EOF
    
    myRST2.AddNew
    myRST2![ID] = "STN" & Format(myRST!ID, "0000")
    myRST2![FULLNAME] = "STN" & Format(myRST!ID, "0000")
    myRST2![Password] = "xxx"
    myRST2.Update

    myRST.MoveNext
Loop

myRST.Close
myRST2.Close



'set this as the source of the drop box for logging in.


Me.cboSelectUser.RowSource = "SELECT * FROM tmpCboLoginList"
 

End Sub

Private Sub lblWelcome_Click()
myComputerName = Environ$("computername")

If (myComputerName = "RKNB-WIN8") Or (myComputerName = "ALBERTKALLAL-PC") Or (myComputerName = "PC-EDM-0016") Or (myComputerName = "PC-EDM-0013") Then
    Me.cboSelectUser = 70
    Me.txtEnterPassword = "31184"
    Call txtEnterPassword_AfterUpdate
End If

End Sub

Private Sub txtEnterPassword_AfterUpdate()
'Validate password, then open frmLogin (hidden) at the correct record, close this form and open the correct main menu form.

'Compare password to password on file. If it was a station number, it would have been intercepted after the cbo box was updated.


DoCmd.OpenForm "frmLogin", acNormal, , "[EmployeeID] = " & Me.cboSelectUser, , acHidden

Forms!frmLogin.cboLoginSelect = Me.cboSelectUser

Select Case Me.frmScreenMode

Case 1  'Desktop Mode
    Call Forms("frmLogin").cmdLogin_Click
    
Case 2
    MsgBox "Tablet Mode is in early development. Do not use."
    DoCmd.OpenForm "frm10_MainMenu"

Case 3
    MsgBox "SmartPhone Mode is in early development. Do not use."
    DoCmd.OpenForm "frm4_MainMenu"
End Select

DoCmd.Close acForm, "frmGetPassword"

End Sub

Private Sub txtEnterPassword_BeforeUpdate(Cancel As Integer)

Cancel = False

If Me.txtEnterPassword <> DLookup("Password", "dbo_CompanyEmployee", "[ID] = " & Me.cboSelectUser) Then

    Cancel = True
    'Password was incorrect. Clear it off and try again.
    MsgBox "Password incorrect. Please try again.", vbCritical, ProgramName
    Me.txtEnterPassword.Undo
End If

End Sub