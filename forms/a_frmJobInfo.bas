Version =20
VersionRequired =20
PublishOption =1
Checksum =-1330496547
Begin Form
    AutoResize = NotDefault
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =19162
    DatasheetFontHeight =11
    ItemSuffix =13
    Left =75
    Top =60
    Right =20055
    Bottom =11175
    DatasheetGridlinesColor =16446942
    RecSrcDt = Begin
        0xce613317f13ae440
    End
    GUID = Begin
        0x91f1e8f38632be4084ec2fdd78549be7
    End
    NameMap = Begin
        0x0acc0e5500000000bdebfab105669c4ba06ba671c3ca05e60100000053b5a253 ,
        0x6a3be440000000000000000061005f00660072006d004a006f00620049006e00 ,
        0x66006f00530075006200000000000000fc5c5de2c3d4fc4b993f12b4380faaef ,
        0x01000000a01f1f72ec62e440000000000000000061005f00660072006d004f00 ,
        0x700065007200610074006f007200530075006200000000000000c63e505fc975 ,
        0x2c4f9dceb489f926982401000000a5e13272ec62e44000000000000000006600 ,
        0x72006d004d00610069006e007400610069006e00730053007500620000000000 ,
        0x00008d080296404e4544b5ff4b3cf0c2303b01000000ee3f1e72ec62e4400000 ,
        0x000000000000660072006d004d0061006300680069006e006500530075006200 ,
        0x000000000000000000000000000000000000000000000c000000050000000000 ,
        0x000000000000000000000000
    End
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c000c03032f000001000100ea0a6f08640001000f00580202000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200d0000c030000c2ac90510000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000070000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000d0000000534d544a ,
        0x000000001000c000530065006e006400200054006f0020004d00690063007200 ,
        0x6f0073006f006600740020004f006e0065004e006f0074006500200032003000 ,
        0x3100300020004400720069007600650072000000524553444c4c00556e697265 ,
        0x73444c4c00506170657253697a65004c4554544552004f7269656e746174696f ,
        0x6e00504f525452414954005265736f6c7574696f6e0044504936303000436f6c ,
        0x6f724d6f64650032346270700000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNames = Begin
        0x08002e0043000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000006e756c3a00000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    PrtDevModeW = Begin
        0x0000720001000000b4c172001015c509000000000815c509b897720007000000 ,
        0x000000001015c509c000c5090a0000000815c509520300006002c509b4c17200 ,
        0x01040006dc000c03032f000001000100ea0a6f08640001000f00580202000100 ,
        0x5802030001004c00650074007400650072000000c000c50900000000a004c509 ,
        0x01000000b4c172001015c509030000006002c5090000c8420000000048000000 ,
        0x0000000002000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200d0000c030000c2ac90510000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000070000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000d0000000534d544a ,
        0x000000001000c000530065006e006400200054006f0020004d00690063007200 ,
        0x6f0073006f006600740020004f006e0065004e006f0074006500200032003000 ,
        0x3100300020004400720069007600650072000000524553444c4c00556e697265 ,
        0x73444c4c00506170657253697a65004c4554544552004f7269656e746174696f ,
        0x6e00504f525452414954005265736f6c7574696f6e0044504936303000436f6c ,
        0x6f724d6f64650032346270700000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNamesW = Begin
        0x04002a003f000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000006e00 ,
        0x75006c003a000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000
    End
    NoSaveCTIWhenDisabled =1
    NoSaveCTIWhenDisabled =1
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin Section
            CanGrow = NotDefault
            Height =9184
            Name ="Detail"
            GUID = Begin
                0x72ed24a7dfdd7641aac0bcb6e307e9e8
            End
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1701
                    Top =283
                    Height =315
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtOrderNum"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0xa79c93e822b33e4a912ffbad0945b98b
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =1701
                    LayoutCachedTop =283
                    LayoutCachedWidth =3402
                    LayoutCachedHeight =598
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Top =285
                            Width =1425
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label1"
                            Caption ="Order Number"
                            GUID = Begin
                                0xbfa99fcacf3b7749b11e10bda2a9fbe9
                            End
                            GridlineColor =10921638
                            LayoutCachedTop =285
                            LayoutCachedWidth =1425
                            LayoutCachedHeight =600
                        End
                    End
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =215
                    Left =113
                    Top =1090
                    Width =18780
                    Height =3105
                    TabIndex =2
                    BorderColor =10921638
                    Name ="frmJobInfoSub"
                    SourceObject ="Form.a_frmJobInfoSub"
                    GUID = Begin
                        0xf5adabd30a31a2439f354e4df29e74cd
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =113
                    LayoutCachedTop =1090
                    LayoutCachedWidth =18893
                    LayoutCachedHeight =4195
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =113
                            Top =793
                            Width =1500
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label3"
                            Caption ="Order Details"
                            GUID = Begin
                                0x1e071467b911e54aa192339131d9866e
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =113
                            LayoutCachedTop =793
                            LayoutCachedWidth =1613
                            LayoutCachedHeight =1108
                        End
                    End
                End
                Begin TextBox
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3458
                    Top =283
                    Width =1071
                    Height =315
                    TabIndex =1
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtJump"
                    OnEnter ="[Event Procedure]"
                    GUID = Begin
                        0x2ce3ee141660bf408e85026041a8a1c5
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =3458
                    LayoutCachedTop =283
                    LayoutCachedWidth =4529
                    LayoutCachedHeight =598
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =215
                    Left =165
                    Top =4589
                    Width =7950
                    Height =1650
                    TabIndex =3
                    BorderColor =10921638
                    Name ="frmOperatorSub"
                    SourceObject ="Form.a_frmOperatorSub"
                    GUID = Begin
                        0xe1972b91222c6542aeb6eec9a344c4f2
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =165
                    LayoutCachedTop =4589
                    LayoutCachedWidth =8115
                    LayoutCachedHeight =6239
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =170
                            Top =4316
                            Width =915
                            Height =285
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label11"
                            Caption ="Operator"
                            GUID = Begin
                                0xfc631302d3117c47b389e55bd77fccef
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =170
                            LayoutCachedTop =4316
                            LayoutCachedWidth =1085
                            LayoutCachedHeight =4601
                        End
                    End
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =226
                    Top =6767
                    Width =6270
                    Height =1650
                    TabIndex =4
                    BorderColor =10921638
                    Name ="frmMaintainsSub"
                    SourceObject ="Form.frmMaintainsSub"
                    GUID = Begin
                        0x7b6a4b372a04b64c8c961a14b5672a4c
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =226
                    LayoutCachedTop =6767
                    LayoutCachedWidth =6496
                    LayoutCachedHeight =8417
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =226
                            Top =6471
                            Width =1335
                            Height =285
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label12"
                            Caption ="Maintenance "
                            GUID = Begin
                                0x64617e2fb4a1f94faf7be31993fd0290
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =226
                            LayoutCachedTop =6471
                            LayoutCachedWidth =1561
                            LayoutCachedHeight =6756
                        End
                    End
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =8220
                    Top =4610
                    Width =10665
                    Height =3930
                    TabIndex =5
                    BorderColor =10921638
                    Name ="frmMachineSub"
                    SourceObject ="Form.frmMachineSub"
                    GUID = Begin
                        0x7c75c86a47ab9a4fa4ffd74d45a256d0
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =8220
                    LayoutCachedTop =4610
                    LayoutCachedWidth =18885
                    LayoutCachedHeight =8540
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =8220
                            Top =4275
                            Width =1485
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label10"
                            Caption ="Machine Status"
                            GUID = Begin
                                0x8eb9f894452f514482261e683b8e56a6
                            End
                            GridlineColor =10921638
                            LayoutCachedLeft =8220
                            LayoutCachedTop =4275
                            LayoutCachedWidth =9705
                            LayoutCachedHeight =4590
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Sub txtJump_Enter()

    ' jump cursor back to prompt box
    
    Me.txtOrderNum.SetFocus
    
End Sub

Private Sub txtOrderNum_AfterUpdate()
    
    Dim strSQL      As String
        
    Me.frmJobInfoSub.visible = False
    Me.frmOperatorSub.visible = False
    Me.frmMaintainsSub.visible = False
    Me.frmMachineSub.visible = False
    
    
    If IsNull(Me.txtOrderNum) = False Then

        Me.frmJobInfoSub.Form.RecordSource = "select * from qryJobInfo where dbo_T_Product.OrderNo = '" & Me.txtOrderNum & "'"
        If Me.frmJobInfoSub.Form.Recordset.RecordCount > 0 Then
            Me.frmJobInfoSub.visible = True
            Call ShowOperator
            Call ShowMaintains
            Call ShowMachine
        End If
    End If


End Sub


Sub ShowOperator()

    ' display list of operators (who worked on this order).
    
    Dim strSQL      As String
    Dim strWhere    As String
    
    Dim rstD        As DAO.Recordset
    
    Set rstD = Me.frmJobInfoSub.Form.RecordsetClone
    
    ' process start/end times,and display operators.
    ' this is a classic "collsion" routine in which we return ANY start/end pair that overlaps the press job time
    ' based on operator time
    
    rstD.MoveFirst
    Do While rstD.EOF = False
    
        If Not (IsNull(rstD!StartDate) Or IsNull(rstD!FinishDate)) Then
          strWhere = "( (StartDate <= " & quDate(rstD!FinishDate) & ") and (FinishDate >= " & quDate(rstD!StartDate) & ") )"
         
          If strSQL <> "" Then
              strSQL = strSQL & " or "
          End If
        
          strSQL = strSQL & strWhere
        End If
          
        rstD.MoveNext
    Loop
    rstD.Close
    
    strSQL = "select * from qryOperator where " & strSQL
    
    
    Me.frmOperatorSub.Form.RecordSource = strSQL
    Me.frmOperatorSub.visible = True
    

End Sub


Sub ShowMaintains()

   ' display list of any mainstains that occured during this job
    
    Dim strSQL      As String
    Dim strWhere    As String
    
    Dim rstD        As DAO.Recordset
    
    Set rstD = Me.frmJobInfoSub.Form.RecordsetClone
    
    ' process start/end times,and display operators.
    ' this is a SIMPLE in-between query
    
    rstD.MoveFirst
    Do While rstD.EOF = False
    
        If Not (IsNull(rstD!StartDate) Or IsNull(rstD!FinishDate)) Then
          strWhere = "( (MainteDate >= " & quDate(rstD!StartDate) & ") and (MainteDate <= " & quDate(rstD!FinishDate) & ") )"
         
          If strSQL <> "" Then
              strSQL = strSQL & " or "
          End If
        
          strSQL = strSQL & strWhere
        End If
        
        rstD.MoveNext
    Loop
    rstD.Close
    
    strSQL = "select * from qryMaintains where " & strSQL
    
    
    Me.frmMaintainsSub.Form.RecordSource = strSQL
    Me.frmMaintainsSub.visible = True
   
   
End Sub


Sub ShowMachine()

   ' display list of any mainstains that occured during this job
    
    Dim strSQL      As String
    Dim strWhere    As String
    
    Dim rstD        As DAO.Recordset
    
    Set rstD = Me.frmJobInfoSub.Form.RecordsetClone
    
    ' process start/end times,and display operators.
    ' this is a SIMPLE in-between query
    
    rstD.MoveFirst
    Do While rstD.EOF = False
    
        If Not (IsNull(rstD!StartDate) Or IsNull(rstD!FinishDate)) Then
          strWhere = "( (RecordDate >= " & quDate(rstD!StartDate) & ") and (RecordDate <= " & quDate(rstD!FinishDate) & ") )"
         
          If strSQL <> "" Then
              strSQL = strSQL & " or "
          End If
        
          strSQL = strSQL & strWhere
        End If
        
        rstD.MoveNext
    Loop
    rstD.Close
    
    strSQL = "select * from qryMachineStatus where " & strSQL
    
    Me.frmMachineSub.Form.RecordSource = strSQL
    Me.frmMachineSub.visible = True
   
End Sub