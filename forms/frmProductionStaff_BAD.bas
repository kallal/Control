Version =20
VersionRequired =20
PublishOption =1
Checksum =326842136
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =6240
    DatasheetFontHeight =11
    ItemSuffix =12
    Left =2565
    Top =8460
    Right =8865
    Bottom =11445
    DatasheetGridlinesColor =16446942
    RecSrcDt = Begin
        0x20aac8390a2de440
    End
    GUID = Begin
        0x20c2cfafe2bf444ba6c60bc671e1d6a3
    End
    NameMap = Begin
        0x0acc0e5500000000ad4ec56e2c4a6b42b8ce7661163ac5c400000000bd333c72 ,
        0xec62e440000000000000000071007200790043006f006d00700061006e007900 ,
        0x45006d0070006c006f00790065006500530068006900660074004c0069007600 ,
        0x65000000000000001099725207d7084fb39311782e21c10a07000000ad4ec56e ,
        0x2c4a6b42b8ce7661163ac5c44900440000000000000031dbaf12d229f44b9696 ,
        0x06c1e357a6a207000000ad4ec56e2c4a6b42b8ce7661163ac5c4530068006900 ,
        0x6600740042006500670069006e00000000000000000000000000000000000000 ,
        0x0000000007000000ad4ec56e2c4a6b42b8ce7661163ac5c44c006f0063006100 ,
        0x740069006f006e0049004400000000000000b3b9986cdffb034fbf79c0a3d4f3 ,
        0x360a0600000020c2cfafe2bf444ba6c60bc671e1d6a343006f006d0070006100 ,
        0x6e00790045006d0070006c006f007900650065004900440000000000000008f5 ,
        0x0f6f9463d643ae727485f5a183a007000000ad4ec56e2c4a6b42b8ce7661163a ,
        0xc5c443006f006d00700061006e00790045006d0070006c006f00790065006500 ,
        0x4900440000000000000066cd9be06bdb5e46bc9df263ddfd6851000000009e5f ,
        0x0a73ec62e440000000000000000071007200790043006f006d00700061006e00 ,
        0x790045006d0070006c006f007900650065000000000000000000000000000000 ,
        0x00000000000000000c000000050000000000000000000000000000000000
    End
    RecordSource ="qryCompanyEmployeeShiftLive"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010403069c00900343b7000201000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x020000000c010000ffffffff4749533400000000000000000000000044494e55 ,
        0x2200180174031c00bc0819870000000000000000000000000000000000000000 ,
        0x0000000000000000090000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000018010000534d544a ,
        0x00000000100008017b00380030003800440043003900450045002d0035004100 ,
        0x460046002d0034003600620066002d0038003000300034002d00420038004400 ,
        0x3400320038003900340042004300420043007d000000496e70757442696e0031 ,
        0x3000524553444c4c00556e69726573444c4c004475706c6578004e4f4e450044 ,
        0x6f63756d656e744e5570003100436f6c6c617465004f4e00506170657253697a ,
        0x65004c4554544552004f7269656e746174696f6e00504f525452414954005265 ,
        0x736f6c7574696f6e0036303078363030004d6564696154797065004155544f00 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000001c0000005634444d0100000000000000 ,
        0x000000000000000000000000
    End
    PrtDevNames = Begin
        0x08002c0059000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000031302e35302e31 ,
        0x30312e3131350000000000
    End
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    PrtDevModeW = Begin
        0x00000058681aa500200700001015c509009a0e770e000000681aa5000000c509 ,
        0x520300000c8fe3767f00000000ff0000c000c509b4c172004800000000000000 ,
        0x01040306dc00900343b7000201000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c0065007400740065007200000009000000f5c445305b030000 ,
        0xf497720001000000b4c172001015c509000000000815c509b897720007000000 ,
        0x0000000010150000000000000000000000000000010000000000000001000000 ,
        0x020000000c010000ffffffff4749533400000000000000000000000044494e55 ,
        0x2200180174031c00bc0819870000000000000000000000000000000000000000 ,
        0x0000000000000000090000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000018010000534d544a ,
        0x00000000100008017b00380030003800440043003900450045002d0035004100 ,
        0x460046002d0034003600620066002d0038003000300034002d00420038004400 ,
        0x3400320038003900340042004300420043007d000000496e70757442696e0031 ,
        0x3000524553444c4c00556e69726573444c4c004475706c6578004e4f4e450044 ,
        0x6f63756d656e744e5570003100436f6c6c617465004f4e00506170657253697a ,
        0x65004c4554544552004f7269656e746174696f6e00504f525452414954005265 ,
        0x736f6c7574696f6e0036303078363030004d6564696154797065004155544f00 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000001c0000005634444d0100000000000000 ,
        0x000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x0400280055000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000310030002e00350030002e003100300031002e003100 ,
        0x3100350000000000000000000000
    End
    NoSaveCTIWhenDisabled =1
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =480
            BackColor =14342874
            Name ="FormHeader"
            GUID = Begin
                0xda77ccf72592f34aa070264cdf89b091
            End
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
            Begin
                Begin Label
                    FontItalic = NotDefault
                    OverlapFlags =85
                    Left =2400
                    Top =300
                    Width =1035
                    Height =180
                    FontSize =9
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label7"
                    Caption ="EMPLOYEE"
                    GUID = Begin
                        0x679b0faa8981d143a427851aa5363a05
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =2400
                    LayoutCachedTop =300
                    LayoutCachedWidth =3435
                    LayoutCachedHeight =480
                End
                Begin Label
                    FontItalic = NotDefault
                    OverlapFlags =85
                    Top =300
                    Width =1200
                    Height =180
                    FontSize =9
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label8"
                    Caption ="SHIFT START"
                    GUID = Begin
                        0xe26c048df60a0249800e26a0be150dde
                    End
                    GridlineColor =10921638
                    LayoutCachedTop =300
                    LayoutCachedWidth =1200
                    LayoutCachedHeight =480
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =4020
                    Width =2220
                    Height =285
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label11"
                    Caption ="STAFF AT THIS STATION"
                    GUID = Begin
                        0x67dac54377812149821e5f05666b64d5
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4020
                    LayoutCachedWidth =6240
                    LayoutCachedHeight =285
                End
                Begin CommandButton
                    OverlapFlags =85
                    Height =240
                    FontSize =10
                    FontWeight =700
                    ForeColor =4210752
                    Name ="cmdStartShift"
                    Caption ="START Shift"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xecb16d5047ed25499126bca44b9031d7
                    End
                    GridlineColor =10921638
                    LayoutCachedWidth =1440
                    LayoutCachedHeight =240
                    BackColor =14732154
                    BorderColor =14732154
                    HoverColor =15392166
                    PressedColor =9402914
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
            End
        End
        Begin Section
            Height =300
            Name ="Detail"
            GUID = Begin
                0x2e2214fb15b4ca4b9de25882c818b00f
            End
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =4380
                    Width =300
                    Height =180
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="ID"
                    ControlSource ="ID"
                    GUID = Begin
                        0x25341fdad4a2f34bb51919a52ad95f20
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4380
                    LayoutCachedWidth =4680
                    LayoutCachedHeight =180
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    IMESentenceMode =3
                    Width =2400
                    Height =300
                    FontSize =10
                    TabIndex =1
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="ShiftBegin"
                    ControlSource ="ShiftBegin"
                    StatusBarText ="Date / time of shift start"
                    GUID = Begin
                        0xcee2e72599d6dd4f8a58cc02400ade39
                    End
                    GridlineColor =10921638
                    LayoutCachedWidth =2400
                    LayoutCachedHeight =300
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =3660
                    Width =480
                    TabIndex =2
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="LocationID"
                    ControlSource ="LocationID"
                    StatusBarText ="Link to which location this user is at"
                    GUID = Begin
                        0x93fbb4c999ae3245ab5ca93a6356ac81
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =3660
                    LayoutCachedWidth =4140
                    LayoutCachedHeight =240
                End
                Begin CommandButton
                    OverlapFlags =95
                    Left =4680
                    Width =600
                    Height =300
                    FontSize =8
                    TabIndex =3
                    ForeColor =4210752
                    Name ="Command9"
                    Caption ="10 MIN"
                    GUID = Begin
                        0x8a69dfccd1bda14aabd5023728716d70
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =4680
                    LayoutCachedWidth =5280
                    LayoutCachedHeight =300
                    BackColor =14732154
                    BorderColor =14732154
                    HoverColor =15392166
                    PressedColor =9402914
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OverlapFlags =255
                    IMESentenceMode =3
                    Left =2400
                    Width =2280
                    Height =300
                    TabIndex =4
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtCompanyEmployee"
                    ControlSource ="=[CompanyEmployeeID].[column](1)"
                    StatusBarText ="Link to dbo_CompanyEmployee"
                    GUID = Begin
                        0xd93cc50d09353f46a5c2312e5705d0ee
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =2400
                    LayoutCachedWidth =4680
                    LayoutCachedHeight =300
                End
                Begin ComboBox
                    Visible = NotDefault
                    OverlapFlags =247
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =1740
                    Top =120
                    Width =1260
                    Height =180
                    TabIndex =5
                    BorderColor =10921638
                    ForeColor =4210752
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"0\""
                    GUID = Begin
                        0xb3b9986cdffb034fbf79c0a3d4f3360a
                    End
                    Name ="CompanyEmployeeID"
                    ControlSource ="CompanyEmployeeID"
                    RowSourceType ="Table/Query"
                    RowSource ="qryCompanyEmployee"
                    ColumnWidths ="0;1440"
                    StatusBarText ="Link to dbo_CompanyEmployee"
                    BaseInfo ="\"qryCompanyEmployee\";\"dbo_CompanyEmployee\";\"\";\"ID\";\"FN] & \"\" \"\" & ["
                        "LN\";\"dbo_CompanyEmployee$PrimaryKey\""
                    GridlineColor =10921638
                    LayoutCachedLeft =1740
                    LayoutCachedTop =120
                    LayoutCachedWidth =3000
                    LayoutCachedHeight =300
                    ForeThemeColorIndex =0
                    ForeTint =75.0
                    ForeShade =100.0
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5340
                    Width =900
                    Height =300
                    FontSize =10
                    FontWeight =700
                    TabIndex =6
                    ForeColor =4210752
                    Name ="Command1"
                    Caption ="END SHIFT"
                    GUID = Begin
                        0x97c2716e8d4bd1418580983c61e6d281
                    End
                    GridlineColor =10921638
                    LayoutCachedLeft =5340
                    LayoutCachedWidth =6240
                    LayoutCachedHeight =300
                    BackColor =14732154
                    BorderColor =14732154
                    HoverColor =15392166
                    PressedColor =9402914
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =14342874
            Name ="FormFooter"
            GUID = Begin
                0xb1988ef1f697d0408e70f6ae467023f1
            End
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub cmdStartShift_Click()
myResponse = ""
myResponse = InputBox("Please scan your Employee barcode, or enter your ID.", ProgramName)
If myResponse = "" Then
    Exit Sub
End If


If Left(myResponse, 3) = "EMP" And Len(myResponse) = 7 Then
    'Login this user
    Dim MYDB As Database
    Dim myRST As Recordset
    Dim myRST2 As Recordset
    Set MYDB = CurrentDb()
    Set myRST = MYDB.OpenRecordset("dbo_CompanyEmployee", dbOpenDynaset, dbSeeChanges)
    myEmployeeID = Val(Right(myResponse, 4))
    myRST.FindFirst "[ID] = " & myEmployeeID
    If myRST.NoMatch Then 'Check if employee ID ok
        MsgBox "Employee not found. Please try again.", vbCritical, ProgramName
        Exit Sub
    End If
    
    Set myRST2 = MYDB.OpenRecordset("dbo_CompanyEmployeeShift", dbOpenDynaset, dbSeeChanges)
    myRST2.FindFirst "[CompanyEmployeeID] = " & myEmployeeID 'Check if this user is already logged in to a shift anywhere.
    If myRST2.NoMatch = True Then
    
        myRST2.AddNew
        myRST2!CompanyEmployeeID = myRST!ID
        myRST2!ShiftBegin = Now
        myRST2!StationID = rsLocSS!StationID
        myRST2.Update
    Else
        MsgBox "This Employee is already logged in.", vbCritical, ProgramName
        Exit Sub
    End If
    
Else
    MsgBox "Employee not found. Please try again.", vbCritical, ProgramName
End If

Me.Requery

End Sub